<!-- Below is script for gmaps4rails -->
<!--<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>-->
<div class="row">
  <div class="col-sm-12 col-md-6">
    <div class="jumbotron">
      <h3 class="bus_name"><strong><%= @business.title %></strong></h3>
      <p>
          <strong>Average Rating: </strong><%= number_with_precision(
              @business.reviews.average("rating"), :precision => 2 || 0) 
              %>
      </p>
      <p>
        <strong>About:</strong>
        <%= @business.text %>
      </p>
      <p>
        <strong>Address:</strong>
        <!--<a href="http://maps.google.com/?q=<%= @business.street %>,<%= @business.city %>,<%= @business.state %>,<%= @business.zip_code %>&z=14" target="blank">-->
        <a href="http://maps.apple.com/?q=<%= @business.title %> <%= @business.city %> <%= @business.zip_code %>&z=14" target="blank">
          
          <%= @business.street %>
          <%= @business.city %>, 
          <%= @business.state %>  
          <%= @business.zip_code %>
        </a>
        

      </p>
      <p>
        <strong>Telephone:</strong>
        <%= @business.telephone %>
      </p>
      <p>
        <strong>Website:</strong>
        <a href="<%= @business.website %>" target="blank">Link</a>
        
      </p>
      <p>
        <strong>Hours of Operation:</strong>
        <%= @business.op_hours %>
      </p>
      <p>
        <strong>Category:</strong>
        <%= @business.category %>
      </p>
      <p>
        <% if can? :update, @business %>
            <%= link_to "Edit", edit_business_path(@business) %> | 
        <% end %>
        <% if can? :destroy, @business %>
            <%= link_to "Destroy", @business, data: { confirm: 'Are you sure?' }, method: :delete %>
        <% end %>
      </p>
    </div><!-- Jumbotron -->
  </div><!-- col-sm-12 col-md-6 -->
  <div class="col-sm-12 col-md-6">
    <div style='width: 100%;' id="map">
      <!-- This is a static googleMap to serve as a placeholder until I can get
        gmaps4rails working. -->
      <a href="http://maps.apple.com/?q=<%= @business.title %> <%= @business.city %> <%= @business.zip_code %>&z=14" target="blank">
          <img src="http://maps.googleapis.com/maps/api/staticmap?center=<%= @business.latitude %>, <%= @business.longitude %>&zoom=14&size=600x400&maptype=roadmap
    &markers=color:red%7C<%= @business.latitude %>, <%= @business.longitude %>" class="img-responsive img-rounded map">
      </a>
      <!-- Below is div for gmaps4rails -->
      <!--<div style='width: 800px;'>
        <div id="map" style='width: 800px; height: 400px;'></div>
      </div>-->
    </div>
  </div><!-- col-sm-12 col-md-6 -->
</div><!-- row -->
<div class="row">
  <div class="col-sm-12">
    <div class="well">
      <h2>Add a review:</h2>
      <%= simple_form_for([@business, @business.reviews.build]) do |f| %>
        <%= f.error_notification %>
        <p>
          <%= f.input :review %>
        </p>
        <p>
          <%= f.input :rating, collection: 1..10 %>
        </p>
        <p>
          <%= f.submit :class => 'btn btn-primary' %>
        </p>
      <% end %> 
      <%= link_to('Back', businesses_path, :class => 'btn btn-primary')  %>
    </div><!-- well -->
  </div><!-- col-sm-12 -->
</div><!-- row -->
<div class="row">
  <div class="col-sm-12">
    <h2>Reviews</h2>
    <%= render @business.reviews.reverse_order %>
  </div><!-- col-sm-12 -->
</div>
<!-- Below is script for gmaps4rails -->
<!--<script type="text/javascript">
  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
    markers = handler.addMarkers(<%= raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
    //handler.map.centerOn(markers[0]);
  });
</script>-->